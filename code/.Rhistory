y=data$y
fenzi=(t(rep(1,n))%*%solve(t(X)%*%X)%*%Q%*%y)^2
fenmu=var(y)*(t(rep(1,n))%*%solve(t(X)%*%X)%*%Q%*%solve(t(X)%*%X)%*%rep(1,n))
T=fenzi/fenmu
}
REL=NULL
for(i in 1:1000){
REL[i]=simul()
}
#xxx=NULL
#for(j in 1:length(REL)){
#xxx[j]=qchisq((j-0.5)/length(REL),df=1)
#}
#plot(xxx,sort(REL))
#abline(0,1)
#hist(pchisq(REL,df=1))
(power=mean(pchisq(REL,df=1,lower.tail = FALSE)<0.05))
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
str(solve(t(X) %*% X))
solve(t(X) %*% X) %*% rep(1, n)
solve(t(X) %*% X) %*% rep(1, n) %*% t(rep(1, n))
solve(t(X)%*%X)%*%rep(1,n)%*%t(rep(1,n))%*%solve(t(X)%*%X)
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
(power=mean(pchisq(REL,df=1,lower.tail = FALSE)<0.05))
source('~/regressionPaper/code/code.R')
(power=mean(pchisq(REL,df=1,lower.tail = FALSE)<0.05))
source('~/regressionPaper/code/code.R')
cat(power=mean(pchisq(REL,df=1,lower.tail = FALSE)<0.05))
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
?&
?`&`
?choose
cat(power=mean(pchisq(REL,df=1,lower.tail = FALSE)<0.05))
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
n=10
p=20
beta=c(rep(1,5),rep(0,p-5))
beta=beta/sqrt(sum(beta^2))
beta=sqrt(betaMod)*beta
generateData=function(){
X=rep(0,n*p)
dim(X)=c(n,p)
Z=rnorm(n*(p+T-1),0,1)
dim(Z)=c(n,p+T-1)
for(i in 1:n)for(j in 1:p){
X[i,j]=muX[j]+sum(rho*Z[i,j:(j+T-1)])
}
y=X%*%beta+rep(alpha,n)+rnorm(n,0,sqrt(varEpsilon))
theSigma=rep(0,p*p)
dim(theSigma)=c(p,p)
for(i in 1:p)for(j in 1:p){
if(abs(i-j)<T){
temp=0
for(k in 1:(T-abs(i-j))){
temp=temp+rho[k]*rho[k+abs(i-j)]
}
theSigma[i,j]=temp
}
}
list(X=X,y=y,theSigma=theSigma)
}
Q=diag(n)-rep(1,n)%*%t(rep(1,n))/n
simul=function(){
data=generateData()
X=t(data$X)
y=data$y
theSigma=data$theSigma
myInv=solve(t(X)%*%X)
fenzi=(t(rep(1,n))%*%myInv%*%Q%*%y)^2
myVar=function(y){
4
#1/(n-2)*t(y)%*%Q%*%(
#    diag(n)-
#        solve(t(X)%*%X)%*%rep(1,n)%*%t(rep(1,n))%*%solve(t(X)%*%X)/
#        as.numeric(t(rep(1,n))%*%solve(t(X)%*%X)%*%Q%*%solve(t(X)%*%X)%*%rep(1,n))
#    )%*%Q%*%y
}
fenmu=myVar(y)*(t(rep(1,n))%*%myInv%*%Q%*%myInv%*%rep(1,n))
T=fenzi/fenmu
thePhi=function(i1,i2,i3,i4){
1/4*t(X[,i1]-X[,i2])%*%(X[,i3]-X[,i4])*(y[i1]-y[i2])*(y[i3]-y[i4])
}
theTemp=0
for(i1 in 1:n)for(i2 in 1:n)for(i3 in 1:n)for(i4 in 1:n){
if(i1!=i2&i1!=i3&i1!=i4&i2!=i3&i2!=i4&i3!=i4){
theTemp=theTemp+thePhi(i1,i2,i3,i4)
}
}
theTemp=theTemp*n*(n-1)*(n-2)*(n-3)/4/3/2/1
ChenT=n*theTemp/sqrt(2*sum(diag(theSigma)))/4
list(T=T,ChenT=ChenT)
}
REL=NULL
ChenREL=NULL
for(i in 1:1000){
temp=simul()
REL[i]=temp$T
ChenREL[i]=temp$ChenT
}
i
beta=c(rep(1,5),rep(0,p-5))
beta=beta/sqrt(sum(beta^2))
beta=sqrt(betaMod)*beta
generateData=function(){
X=rep(0,n*p)
dim(X)=c(n,p)
Z=rnorm(n*(p+T-1),0,1)
dim(Z)=c(n,p+T-1)
for(i in 1:n)for(j in 1:p){
X[i,j]=muX[j]+sum(rho*Z[i,j:(j+T-1)])
}
y=X%*%beta+rep(alpha,n)+rnorm(n,0,sqrt(varEpsilon))
theSigma=rep(0,p*p)
dim(theSigma)=c(p,p)
for(i in 1:p)for(j in 1:p){
if(abs(i-j)<T){
temp=0
for(k in 1:(T-abs(i-j))){
temp=temp+rho[k]*rho[k+abs(i-j)]
}
theSigma[i,j]=temp
}
}
list(X=X,y=y,theSigma=theSigma)
}
Q=diag(n)-rep(1,n)%*%t(rep(1,n))/n
simul=function(){
data=generateData()
X=t(data$X)
y=data$y
theSigma=data$theSigma
myInv=solve(t(X)%*%X)
fenzi=(t(rep(1,n))%*%myInv%*%Q%*%y)^2
myVar=function(y){
4
#1/(n-2)*t(y)%*%Q%*%(
#    diag(n)-
#        solve(t(X)%*%X)%*%rep(1,n)%*%t(rep(1,n))%*%solve(t(X)%*%X)/
#        as.numeric(t(rep(1,n))%*%solve(t(X)%*%X)%*%Q%*%solve(t(X)%*%X)%*%rep(1,n))
#    )%*%Q%*%y
}
fenmu=myVar(y)*(t(rep(1,n))%*%myInv%*%Q%*%myInv%*%rep(1,n))
T=fenzi/fenmu
thePhi=function(i1,i2,i3,i4){
1/4*t(X[,i1]-X[,i2])%*%(X[,i3]-X[,i4])*(y[i1]-y[i2])*(y[i3]-y[i4])
}
theTemp=0
for(i1 in 1:n)for(i2 in 1:n)for(i3 in 1:n)for(i4 in 1:n){
if(i1!=i2&i1!=i3&i1!=i4&i2!=i3&i2!=i4&i3!=i4){
theTemp=theTemp+thePhi(i1,i2,i3,i4)
}
}
theTemp=theTemp*n*(n-1)*(n-2)*(n-3)/4/3/2/1
ChenT=n*theTemp/sqrt(2*sum(diag(theSigma)))/4
list(T=T,ChenT=ChenT)
}
REL=NULL
ChenREL=NULL
for(i in 1:1000){
temp=simul()
REL[i]=temp$T
ChenREL[i]=temp$ChenT
}
i
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
n=40
p=310
beta=c(rep(1,5),rep(0,p-5))
beta=beta/sqrt(sum(beta^2))
beta=sqrt(betaMod)*beta
generateData=function(){
X=rep(0,n*p)
dim(X)=c(n,p)
Z=rnorm(n*(p+T-1),0,1)
dim(Z)=c(n,p+T-1)
for(i in 1:n)for(j in 1:p){
X[i,j]=muX[j]+sum(rho*Z[i,j:(j+T-1)])
}
y=X%*%beta+rep(alpha,n)+rnorm(n,0,sqrt(varEpsilon))
theSigma=rep(0,p*p)
dim(theSigma)=c(p,p)
for(i in 1:p)for(j in 1:p){
if(abs(i-j)<T){
temp=0
for(k in 1:(T-abs(i-j))){
temp=temp+rho[k]*rho[k+abs(i-j)]
}
theSigma[i,j]=temp
}
}
list(X=X,y=y,theSigma=theSigma)
}
Q=diag(n)-rep(1,n)%*%t(rep(1,n))/n
simul=function(){
data=generateData()
X=t(data$X)
y=data$y
theSigma=data$theSigma
myInv=solve(t(X)%*%X)
fenzi=(t(rep(1,n))%*%myInv%*%Q%*%y)^2
myVar=function(y){
4
#1/(n-2)*t(y)%*%Q%*%(
#    diag(n)-
#        solve(t(X)%*%X)%*%rep(1,n)%*%t(rep(1,n))%*%solve(t(X)%*%X)/
#        as.numeric(t(rep(1,n))%*%solve(t(X)%*%X)%*%Q%*%solve(t(X)%*%X)%*%rep(1,n))
#    )%*%Q%*%y
}
fenmu=myVar(y)*(t(rep(1,n))%*%myInv%*%Q%*%myInv%*%rep(1,n))
T=fenzi/fenmu
thePhi=function(i1,i2,i3,i4){
1/4*t(X[,i1]-X[,i2])%*%(X[,i3]-X[,i4])*(y[i1]-y[i2])*(y[i3]-y[i4])
}
theTemp=0
for(i1 in 1:n)for(i2 in 1:n)for(i3 in 1:n)for(i4 in 1:n){
if(i1!=i2&i1!=i3&i1!=i4&i2!=i3&i2!=i4&i3!=i4){
theTemp=theTemp+thePhi(i1,i2,i3,i4)
}
}
theTemp=theTemp*n*(n-1)*(n-2)*(n-3)/4/3/2/1
ChenT=n*theTemp/sqrt(2*sum(diag(theSigma)))/4
list(T=T,ChenT=ChenT)
}
REL=NULL
ChenREL=NULL
for(i in 1:100){
temp=simul()
REL[i]=temp$T
ChenREL[i]=temp$ChenT
}
i
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
jjjjj
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
ChenT=pnorm(qnorm(0.05)+n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4)
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
debugSource('~/regressionPaper/code/code.R')
ChenT
ChenT
ChenT
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
debugSource('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
pnorm(qnorm(0.05)+2.89)
pnorm(qnorm(0.05)+1.92)
pnorm(qnorm(0.05)+0.092)
pnorm(qnorm(0.05)+0.92)
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
var(rnorm(10,0,4))
qnorm(0.05)
ChenT
ChenT
rho
rho
debugSource('~/regressionPaper/code/code.R')
rho
sum(beta^2)
theSigma
sum(theSigma^2)
2*sum(theSigma^2)
sqrt(2*sum(theSigma^2))
sum((theSigma%*%beta)^2)
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
eigen(theSigma)$values
mean(eigen(theSigma)$values)
debugSource('~/regressionPaper/code/code.R')
ChenT
pnorm(qnorm(0.05)+0.3)
sum((var(t(X))-theSigma)^2)
var(t(X))
eigen(var(t(X)))$vectors
eigen(var(t(X)))$values
debugSource('~/regressionPaper/code/code.R')
var(X)[1:5,1:5]
theSigma[1:5,1:5]
var(Z)
var(as.vector(Z))
theSigma[1:5,1:5]
rho[1]
sum(rho^2)
theSigma[1:5,1:5]
debugSource('~/regressionPaper/code/code.R')
theSigma[1:5,1:5]
var(X)[1:5,1:5]
debugSource('~/regressionPaper/code/code.R')
theSigma[1:5,1:5]
var(X)[1:5,1:5]
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
sum(beta^2)
theSigma
theSigma[1,1:10]
theSigma[1,1:10]/theSigma[1,1]
theSigma[1,1:20]/theSigma[1,1]
debugSource('~/regressionPaper/code/code.R')
theSigma[1,1:20]/theSigma[1,1]
theSigma[1,1:20]/theSigma[1,1]
debugSource('~/regressionPaper/code/code.R')
theSigma[1,1:20]/theSigma[1,1]
debugSource('~/regressionPaper/code/code.R')
theSigma[1,1:20]/theSigma[1,1]
debugSource('~/regressionPaper/code/code.R')
theSigma[1,1:20]/theSigma[1,1]
?sample
sample.int(10)
debugSource('~/regressionPaper/code/code.R')
ChenT
debugSource('~/regressionPaper/code/code.R')
ChenT
debugSource('~/regressionPaper/code/code.R')
debugSource('~/regressionPaper/code/code.R')
ChenT
debugSource('~/regressionPaper/code/code.R')
ChenT
debugSource('~/regressionPaper/code/code.R')
ChenT
beta
debugSource('~/regressionPaper/code/code.R')
ChenT
debugSource('~/regressionPaper/code/code.R')
ChenT
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4)
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
ChenT
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
debugSource('~/regressionPaper/code/code.R')
ChenT
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
ChenT
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
source('~/regressionPaper/code/code.R')
jjjjj
pnorm(qnorm(0.05)+0.92)
pnorm(qnorm(0.05)+0.61)
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
debugSource('~/regressionPaper/code/code.R')
sum(beta^2)
debugSource('~/regressionPaper/code/code.R')
sum(beta^2)
debugSource('~/regressionPaper/code/code.R')
debugSource('~/regressionPaper/code/code.R')
sum((theSigma%*%beta)^2)
beta=beta[sample.int(p)]
sum((theSigma%*%beta)^2)
beta=beta[sample.int(p)]
sum((theSigma%*%beta)^2)
source('~/regressionPaper/code/code.R')
jjjjj
source('~/regressionPaper/code/code.R')
jjjjj
sum(beta^2)
source('~/regressionPaper/code/code.R')
sum(beta^2)
jjjjj
debugSource('~/regressionPaper/code/code.R')
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
beta=beta[sample.int(p)]
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
ChenT
ChenT2
debugSource('~/regressionPaper/code/code.R')
ChenT=pnorm(qnorm(0.05)+n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4)
ChenT
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
beta=beta[sample.int(p)]
ChenT2=pnorm(qnorm(0.05)+n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4)
ChenT2
n*sum((theSigma%*%beta)^2)/sqrt(2*sum(theSigma^2))/4
source('~/regressionPaper/code/code.R')
jjjjj
jjj=NULL
for(myMod in c(0,0.02,0.04,0.06)){
jjj=c(jjj,list(list(n=40,p=310,myMod=myMod)))
}
jjj
outData=data.frame(n,p,myMod,Chen,new)
?data.frame
source('~/regressionPaper/code/code.R')
data.frame(outN,outP,outMod,outChen,outNew)
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
data.frame(outN,outP,outMod,outChen,outNew)
source('~/regressionPaper/code/code.R')
data.frame(outN,outP,outMod,outChen,outNew)
library(xtable)
resul=data.frame(outN,outP,outMod,outChen,outNew)
xtable(resul)
myTable=xtable(resul)
myTable
digits(myTable)=c(0,0,2,2,2)
digits(myTable)=c(0,0,0,2,2,2)
myTable
?xtable
method(print)
methods(print)
print(myTable,include.rownames = FALSE)
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
source('~/regressionPaper/code/code.R')
